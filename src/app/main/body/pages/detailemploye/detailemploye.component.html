<div class="row">
  <p-toast />
  <!-- User Sidebar -->
  <div class="col-xl-4 col-lg-5 order-1 order-md-0">
    <!-- User Card -->
    <div class="card mb-6">
      <div class="card-body pt-12">
        <div class="user-avatar-section">
          <div class="d-flex align-items-center flex-column">
            <div class="avatar mb-4">
              <img [src]="getProfileImg(employe.sexe)" alt="profile" />
            </div>
            <div class="user-info text-center">
              <h5>{{ employe.nom }} {{ employe.prenom }}</h5>
              <span class="badge bg-label-secondary">
                @if (employe.csp) {
                {{ employe.csp }}
                }@else { Aucune catégorie renseignée } </span
              ><br />
              <span class="badge bg-label-primary">{{ employe.poste }}</span>
            </div>
          </div>
        </div>

        <h5 class="pb-4 border-bottom mb-4">Details</h5>
        <div class="info-container">
          <ul class="list-unstyled mb-6">
            <li class="mb-2">
              <span class="h6">Date d'embauche: </span>
              <span
                >@if (employe.dateEmbauche) {
                {{ employe.dateEmbauche | date : "dd-MM-YYYY" }}
                }@else { Aucune date renseignée }
              </span>
            </li>
            <li class="mb-2">
              <span class="h6">Ancienneté: </span>
              <span>{{ employe.anciennete }}</span>
            </li>
            <li class="mb-2">
              <span class="h6">Téléphone: </span>
              <span>
                @if (employe.tel) {
                {{ employe.tel }}
                }@else { Aucun numéro renseigné }
              </span>
            </li>
            <li class="mb-2">
              <span class="h6">Adresse: </span>
              <span>
                @if (employe.adresse) {
                {{ employe.adresse }}
                }@else { Aucune adresse renseignée }
              </span>
            </li>
            <li class="mb-2">
              <span class="h6">Sexe: </span>
              <span>
                @if (employe.sexe) {
                {{ employe.sexe }}
                } @else { Aucun sexe renseigné }
              </span>
            </li>
            <li class="mb-2">
              <span class="h6">Age: </span>
              <span>{{ employe.age }} ans</span>
            </li>
            <li class="mb-2">
              <span class="h6">Date de Naissance: </span>
              <span>
                @if (employe.dateNaissance) {
                {{ employe.dateNaissance | date : "dd-MM-YYYY" }}
                }@else { Aucune date renseignée }
              </span>
            </li>
            <li class="mb-2">
              <span class="h6">Situation Familiale: </span>
              <span>
                @if (employe.situationFamiliale) {
                {{ employe.situationFamiliale }}
                }@else { Aucune situation renseignée }
              </span>
            </li>
          </ul>
          <div class="d-flex justify-content-center">
            <button
              class="btn btn-primary me-4"
              data-bs-target="#editUser"
              data-bs-toggle="modal"
            >
              Modifier
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- /User Card -->
  </div>
  <!--/ User Sidebar -->

  <!-- User Content -->
  <div class="col-xl-8 col-lg-7 order-0 order-md-1">
    <div
      class="alert alert-warning alert-dismissible"
      role="alert"
      *ngIf="!employe.isActif"
    >
      <p>{{ message }}</p>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="alert"
        aria-label="Fermer"
      ></button>
    </div>
    <div class="nav-align-top mb-4">
      <ul class="nav nav-pills mb-3 nav-fill" role="tablist">
        <li class="nav-item">
          <button
            type="button"
            class="nav-link active"
            role="tab"
            data-bs-toggle="tab"
            data-bs-target="#navs-pills-justified-profile"
            aria-controls="navs-pills-justified-profile"
            aria-selected="false"
          >
            <i class="tf-icons bx bx-user"></i> Contrat
          </button>
        </li>
        <li class="nav-item">
          <button
            type="button"
            class="nav-link"
            role="tab"
            data-bs-toggle="tab"
            data-bs-target="#navs-pills-justified-messages"
            aria-controls="navs-pills-justified-messages"
            aria-selected="false"
          >
            <i class="tf-icons bx bx-message-square"></i> Absences
          </button>
        </li>
      </ul>
      <div class="tab-content">
      
        <div
          class="tab-pane fade show active"
          id="navs-pills-justified-profile"
          role="tabpanel"
        >
          <div class="container mt-4 p-3 border rounded bg-light">
            <!-- Status -->
            <div class="d-flex align-items-center mb-3">
              <span class="me-2"
                ><i class="bi bi-circle text-primary"></i> Type</span
              >
              <span class="fw-bold ms-auto text-primary">
                {{ contrat.type }}</span
              >
            </div>

            <!-- Due Date -->
            <div class="d-flex align-items-center mb-3">
              <span class="me-2"
                ><i class="bx bx-calendar"></i> Date de Début</span
              >
              <span class="fw-bold ms-auto">{{ contrat.dateDebut }}</span>
            </div>

            <!-- Assignee -->
            <div class="d-flex align-items-center mb-3">
              <span class="me-2"
                ><i class="bx bx-calendar"></i> Date de Fin</span
              >
              <span class="fw-bold ms-auto">
                @if (contrat.dateFin) {
                {{ contrat.dateFin }}
                } @else { pas défini }
              </span>
            </div>

            <!-- Tags -->
            <div class="d-flex align-items-center mb-3">
              <span class="me-2"><i class="bx bx-tags"></i>Etat</span>
              <div class="ms-auto">
                @if (contrat.etat) {
                <span class="badge bg-warning text-dark">ACTIF </span>
                } @else {
                <span class="badge bg-warning text-dark">INACTIF</span>
                }
              </div>
            </div>

            <!-- Description -->
            <div>
              <span class="d-block mb-2"
                ><i class="bi bi-card-text"></i> Description</span
              >
              <textarea class="form-control" rows="5" readonly>
            This page aims to provide real-time insights into employee performance metrics and key business indicators.
              </textarea>
            </div>
          </div>
          <div class="d-flex justify-content-between align-item-left mt-3">
            <button
              class="btn btn-danger mt-3"
              (click)="rompreContrat()"
              *ngIf="contrat.etat"
            >
              Résilier le contrat
            </button>

            <button
              class="btn btn-primary mt-3"
              data-bs-target="#upgradePlanModal"
              data-bs-toggle="modal"
            >
              Renouveler le contrat
            </button>
          </div>
        </div>
        <div
          class="tab-pane fade"
          id="navs-pills-justified-messages"
          role="tabpanel"
        >
          <div class="container py-3">
            <div class="row">
              <div class="col-md-10 offset-md-1">
                <ul class="timeline">
                  @for (item of absences; track $index) {
                  <li [ngClass]="getinverted($index)">
                    <div class="timeline-badge bg-primary"></div>
                    <div class="timeline-panel card shadow-sm p-3">
                      <h5 class="timeline-title fw-bold">{{ item.type }}</h5>
                      <p class="text-muted mb-1">
                        Du {{ item.dateDebut | date : "dd-MM-YYYY" }} Au
                        {{ item.dateFin | date : "dd-MM-YYYY" }}
                      </p>
                      <p>{{ item.motif }}</p>
                    </div>
                  </li>
                  }@empty {
                  <li>
                    <div class="timeline-badge bg-primary"></div>
                    <div class="timeline-panel card shadow-sm p-3">
                      <h5 class="timeline-title fw-bold">Aucune absence</h5>
                      <p class="text-muted mb-1">
                        Aucune absence n'a été enregistrée pour le moment
                      </p>
                    </div>
                  </li>
                  }
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--/ User Content -->

  <!-- Modal -->
  <!-- Edit User Modal -->
  <div class="modal fade" id="editUser" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-simple modal-edit-user">
      <div class="modal-content">
        <div class="modal-body">
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
          <div class="text-center mb-6">
            <h4 class="mb-2">Modifier les informations de l'employé</h4>
            <p>Les modifications seront appliquées après soumission.</p>
          </div>
          <form class="row g-6">
            <div class="divider text-start">
              <div class="divider-text">Informations personnelles</div>
            </div>
            <!-- Nom -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="nom">Nom</label>
              <input
                type="text"
                id="nom"
                name="nom"
                [(ngModel)]="employe.nom"
                class="form-control"
                placeholder="Entrez le nom"
                required
              />
            </div>
            <!-- Prénom -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="prenom">Prénom</label>
              <input
                type="text"
                id="prenom"
                name="prenom"
                [(ngModel)]="employe.prenom"
                class="form-control"
                placeholder="Entrez le prénom"
                required
              />
            </div>
            <!-- Téléphone -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="tel">Téléphone</label>
              <input
                type="tel"
                id="tel"
                name="tel"
                [(ngModel)]="employe.tel"
                class="form-control"
                placeholder="Entrez le numéro de téléphone"
                required
              />
            </div>
            <!-- Adresse -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="adresse">Adresse</label>
              <input
                type="text"
                id="adresse"
                name="adresse"
                [(ngModel)]="employe.adresse"
                class="form-control"
                placeholder="Entrez l'adresse"
              />
            </div>
            <!-- Sexe -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="sexe">Sexe</label>
              <select
                id="sexe"
                name="sexe"
                [(ngModel)]="employe.sexe"
                class="form-select"
                required
              >
                <option value="Masculin">Masculin</option>
                <option value="Féminin">Féminin</option>
              </select>
            </div>
            <!-- Situation familiale -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="situationFamiliale"
                >Situation Familiale</label
              >
              <input
                type="text"
                id="situationFamiliale"
                name="situationFamiliale"
                [(ngModel)]="employe.situationFamiliale"
                class="form-control"
                placeholder="Entrez la situation familiale"
              />
            </div>
            <!-- Date de naissance -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="dateNaissance"
                >Date de Naissance</label
              >
              <input
                type="date"
                id="dateNaissance"
                name="dateNaissance"
                [(ngModel)]="employe.dateNaissance"
                class="form-control"
                required
              />
            </div>
            <!-- CSP -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="csp">CSP</label>
              <select
                id="csp"
                name="csp"
                [(ngModel)]="employe.csp"
                class="form-select"
                required
              >
                <option *ngFor="let csp of csps" [ngValue]="csp.libelle">
                  {{ csp.libelle }}
                </option>
              </select>
            </div>
            <div class="divider">
              <div class="divider-text">Contrat</div>
            </div>
            <!-- Poste -->
            <div class="col-12 col-md-6">
              <label class="form-label" for="poste">Poste</label>
              <input
                id="poste"
                name="poste"
                [(ngModel)]="employe.poste"
                class="form-control"
                disabled
              />
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label" for="poste">Type de contrat</label>
              <select
                id="type"
                name="type"
                [(ngModel)]="contrat.type"
                class="form-select"
                required
              >
                <option value="CDD">CDD</option>
                <option value="CDI">CDI</option>
                <option value="STAGE">STAGE</option>
                <option value="INTERIM">INTERIM</option>
              </select>
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label" for="poste">Date de Début</label>
              <input
                id="dateDebut"
                type="date"
                name="contrat.dateDebut"
                [(ngModel)]="contrat.dateDebut"
                class="form-control"
              />
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label" for="poste">Date de Fin</label>
              <input
                id="dateFin"
                name="contrat.dateFin"
                [(ngModel)]="contrat.dateFin"
                class="form-control"
                type="date"
              />
            </div>

            <!-- Boutons -->
            <div class="col-12 text-center mt-3">
              <button
                type="submit"
                class="btn btn-primary me-3"
                (click)="update()"
              >
                Enregistrer
              </button>
              <button
                type="reset"
                class="btn btn-label-secondary"
                data-bs-dismiss="modal"
              >
                Annuler
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!--/ Edit User Modal -->

  <!-- Add New Credit Card Modal -->
  <div
    class="modal fade"
    id="upgradePlanModal"
    tabindex="-1"
    aria-hidden="true"
  >
    <div
      class="modal-dialog modal-dialog-centered modal-simple modal-upgrade-plan"
    >
      <div class="modal-content">
        <div class="modal-body">
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
          <div class="text-center mb-6">
            <h4 class="mb-2">Upgrade Plan</h4>
            <p>Choose the best plan for user.</p>
          </div>
          <form id="upgradePlanForm" class="row g-4" onsubmit="return false">
            <div class="col-sm-9">
              <label class="form-label" for="choosePlan">Choose Plan</label>
              <select
                id="choosePlan"
                name="choosePlan"
                class="form-select"
                aria-label="Choose Plan"
              >
                <option selected>Choose Plan</option>
                <option value="standard">Standard - $99/month</option>
                <option value="exclusive">Exclusive - $249/month</option>
                <option value="Enterprise">Enterprise - $499/month</option>
              </select>
            </div>
            <div class="col-sm-3 d-flex align-items-end">
              <button type="submit" class="btn btn-primary">Upgrade</button>
            </div>
          </form>
        </div>
        <hr class="mx-5 my-2" />
        <div class="modal-body">
          <p class="mb-0">User current plan is standard plan</p>
          <div
            class="d-flex justify-content-between align-items-center flex-wrap"
          >
            <div class="d-flex justify-content-center me-2 mt-1">
              <sup
                class="h6 pricing-currency pt-1 mt-2 mb-0 me-1 text-primary fw-normal"
                >$</sup
              >
              <h1 class="mb-0 text-primary">99</h1>
              <sub class="pricing-duration mt-auto mb-5 pb-1 small text-body"
                >/month</sub
              >
            </div>
            <button class="btn btn-label-danger cancel-subscription">
              Cancel Subscription
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--/ Add New Credit Card Modal -->

  <!-- /Modal -->
</div>
<!-- / Content -->
